{"version":3,"file":"js/ProductSearch.4e30642a.js","mappings":"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","sources":["webpack://relewise-demo/./src/helpers/useListNavigator.ts","webpack://relewise-demo/./src/views/ProductSearch.vue?d326","webpack://relewise-demo/./src/views/ProductSearch.vue"],"sourcesContent":["import { onMounted, onUnmounted, Ref, ref } from 'vue';\n\nexport function useListNavigator(items: Ref<any[]>, callback: (item: any) => void) {\n    const index = ref(0);\n\n    // a composable can update its managed state over time.\n    function update(event: KeyboardEvent) {\n        const code = event.code ?? event.key;\n\n        if (items.value.length <= 1 && code !== 'Enter') {\n            index.value = 0;\n            return;\n        }\n\n        if (code === 'ArrowDown') {\n            index.value = index.value === items.value.length - 1 ? 0 : index.value + 1;\n        }\n        else if (code === 'ArrowUp') {\n            index.value = index.value === 0 ? items.value.length - 1 : index.value - 1;\n        }\n        else if (code === 'Enter') {\n            callback(items.value[index.value]);\n        }\n    }\n\n    function reset() {\n        index.value = 0;\n    }\n\n    // a composable can also hook into its owner component's\n    // lifecycle to setup and teardown side effects.\n    onMounted(() => window.addEventListener('keydown', update));\n    onUnmounted(() => window.removeEventListener('keydown', update));\n\n    // expose managed state as return value\n    return { index, reset };\n}\n","import { defineComponent as _defineComponent } from 'vue'\nimport { vModelText as _vModelText, unref as _unref, createElementVNode as _createElementVNode, withDirectives as _withDirectives, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, withModifiers as _withModifiers, normalizeClass as _normalizeClass, createCommentVNode as _createCommentVNode, createVNode as _createVNode } from \"vue\"\n\nconst _hoisted_1 = { class: \"search\" }\nconst _hoisted_2 = { class: \"mb-5\" }\nconst _hoisted_3 = {\n  key: 0,\n  class: \"mb-5\"\n}\nconst _hoisted_4 = /*#__PURE__*/_createElementVNode(\"h4\", { class: \"text-md mb-1\" }, \"Predictions\", -1)\nconst _hoisted_5 = [\"onClick\"]\nconst _hoisted_6 = {\n  key: 1,\n  class: \"mb-5\"\n}\nconst _hoisted_7 = { class: \"text-xl font-semibold mb-2\" }\nconst _hoisted_8 = { key: 2 }\nconst _hoisted_9 = { class: \"text-xl font-semibold mb-2\" }\nconst _hoisted_10 = { key: 3 }\nconst _hoisted_11 = { class: \"text-xl font-semibold mb-2\" }\n\nimport { ProductSearchBuilder, ProductSearchResponse, SearchCollectionBuilder, SearchTermPredictionBuilder, SearchTermPredictionResponse, SearchTermPredictionResult } from '@relewise/client';\nimport { ref, Ref } from 'vue';\nimport Products from '@/components/Products.vue';\nimport contextStore from '@/stores/context.store';\nimport { useListNavigator } from '@/helpers/useListNavigator';\nimport { useDebounceFn } from '@vueuse/core';\n\n\nexport default /*#__PURE__*/_defineComponent({\n  __name: 'ProductSearch',\n  setup(__props) {\n\nconst result = ref<ProductSearchResponse | null>(null);\nconst predictions: Ref<SearchTermPredictionResponse | null> = ref<SearchTermPredictionResponse | null>(null);\nconst searchTerm: Ref<string> = ref<string>('');\nconst usedSearchTerm: Ref<string> = ref<string>('');\n\nconst searcher = contextStore.getSearcher();\n\nconst predictionsList = ref(predictions.value?.predictions ?? []);\n\nconst { index: selectedIndex, reset } = useListNavigator(predictionsList, (item: SearchTermPredictionResult) => { searchFor(item.term ?? '');});\n\nconst debouncedSearch = useDebounceFn(() => {\n    if (usedSearchTerm.value !== searchTerm.value) {\n        search();\n    }\n}, 200);\n\nasync function search() {\n\n    usedSearchTerm.value = searchTerm.value;\n\n    const request = new SearchCollectionBuilder()\n        .addRequest(new ProductSearchBuilder(contextStore.defaultSettings)\n            .setSelectedProductProperties(contextStore.selectedProductProperties)\n            .setSelectedVariantProperties({allData: true, displayName: true})\n            .setTerm(searchTerm.value)\n            .pagination(p => p.setPageSize(30))\n            .build())\n        .addRequest(new SearchTermPredictionBuilder(contextStore.defaultSettings)\n            .addEntityType('Product')\n            .setTerm(searchTerm.value)\n            .take(5)\n            .build())\n        .build();\n\n    const response = await searcher.batch(request);\n    contextStore.assertApiCall(response);\n\n    reset();\n    if (response && response.responses) {\n        result.value = response.responses[0];\n        predictions.value = response.responses[1];\n        predictionsList.value = response.responses[1]?.predictions ?? [];\n    }\n}\n\nfunction searchFor(term: string) {\n    searchTerm.value = term;\n    search();\n}\n\nreturn (_ctx: any,_cache: any) => {\n  return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n    _createElementVNode(\"div\", _hoisted_2, [\n      _withDirectives(_createElementVNode(\"input\", {\n        type: \"text\",\n        \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event: any) => ((searchTerm).value = $event)),\n        onKeydown: _cache[1] || (_cache[1] = \n//@ts-ignore\n(...args) => (_unref(debouncedSearch) && _unref(debouncedSearch)(...args))),\n        placeholder: \"Search for products\"\n      }, null, 544), [\n        [_vModelText, searchTerm.value]\n      ])\n    ]),\n    (predictions.value && predictions.value.predictions && predictions.value.predictions.length > 0)\n      ? (_openBlock(), _createElementBlock(\"div\", _hoisted_3, [\n          _hoisted_4,\n          (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(predictions.value.predictions, (prediction, index) => {\n            return (_openBlock(), _createElementBlock(\"a\", {\n              key: prediction.term ?? '',\n              onClick: _withModifiers(($event: any) => (searchFor(prediction.term ?? '')), [\"prevent\"]),\n              class: _normalizeClass([\"mb-1 block cursor-pointer\", {'font-semibold': index == _unref(selectedIndex)}])\n            }, _toDisplayString(prediction.term), 11, _hoisted_5))\n          }), 128))\n        ]))\n      : _createCommentVNode(\"\", true),\n    (result.value && result.value?.redirects && result.value.redirects.length > 0)\n      ? (_openBlock(), _createElementBlock(\"div\", _hoisted_6, [\n          _createElementVNode(\"h2\", _hoisted_7, \"Showing redirect(s) for '\" + _toDisplayString(usedSearchTerm.value) + \"'\", 1),\n          (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(result.value.redirects, (redirect) => {\n            return (_openBlock(), _createElementBlock(\"div\", {\n              key: redirect.id,\n              class: \"mb-1 pb-1 flex border-b border-solid border-gray-300\"\n            }, _toDisplayString(redirect.destination), 1))\n          }), 128))\n        ]))\n      : _createCommentVNode(\"\", true),\n    (result.value && result.value?.results && result.value.results.length > 0)\n      ? (_openBlock(), _createElementBlock(\"div\", _hoisted_8, [\n          _createElementVNode(\"h2\", _hoisted_9, \"Showing results for '\" + _toDisplayString(usedSearchTerm.value) + \"' (\" + _toDisplayString(result.value.results.length) + \" of \" + _toDisplayString(result.value.hits) + \")\", 1),\n          _createVNode(Products, {\n            products: result.value?.results\n          }, null, 8, [\"products\"])\n        ]))\n      : (usedSearchTerm.value.length > 0)\n        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_10, [\n            _createElementVNode(\"h2\", _hoisted_11, \"Your search '\" + _toDisplayString(usedSearchTerm.value) + \"' returned no matching products.\", 1)\n          ]))\n        : _createCommentVNode(\"\", true)\n  ]))\n}\n}\n\n})","import script from \"./ProductSearch.vue?vue&type=script&lang=ts&setup=true\"\nexport * from \"./ProductSearch.vue?vue&type=script&lang=ts&setup=true\"\n\nconst __exports__ = script;\n\nexport default __exports__"],"names":["useListNavigator","items","callback","index","ref","update","event","code","key","value","length","reset","onMounted","window","addEventListener","onUnmounted","removeEventListener","_hoisted_1","class","_hoisted_2","_hoisted_3","_hoisted_4","_createElementVNode","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","_hoisted_10","_hoisted_11","_defineComponent","__name","setup","__props","result","predictions","searchTerm","usedSearchTerm","searcher","contextStore","predictionsList","selectedIndex","item","searchFor","term","debouncedSearch","useDebounceFn","search","async","request","SearchCollectionBuilder","addRequest","ProductSearchBuilder","setSelectedProductProperties","setSelectedVariantProperties","allData","displayName","setTerm","pagination","p","setPageSize","build","SearchTermPredictionBuilder","addEntityType","take","response","batch","responses","_ctx","_cache","_openBlock","_createElementBlock","_withDirectives","type","$event","onKeydown","args","_unref","placeholder","_vModelText","_Fragment","_renderList","prediction","onClick","_withModifiers","_normalizeClass","_toDisplayString","_createCommentVNode","redirects","redirect","id","destination","results","hits","_createVNode","Products","products","__exports__"],"sourceRoot":""}